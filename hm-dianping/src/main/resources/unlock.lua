-- KEYS[1]，指的是锁的key，ARGV[1],指的是当前线程标识

-- 从redis中获取的线程标识是之前加锁线程的线程标识
-- 传入的线程标识是当前执行代码线程的线程标识
-- 获取线程标识，判断是否和传入的线程标识一致
if(redis.call('GET', KEYS[1] == ARGV[1])) then
    -- 若线程标识一致，说明是同一个线程执行代码，那么就删除键来释放锁
    return redis.call('DEL',KEYS[1])
end
--若不是同一个线程，那么就直接返回
return 0